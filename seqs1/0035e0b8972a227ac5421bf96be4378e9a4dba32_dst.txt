doc . getMeganFile ( ) . setFileType ( MeganFile . Type . MEGAN_SUMMARY_FILE )  
doc . setDirty ( true )  
newDir . getMainViewer ( ) . setDoReset ( true )  
newDir . execute ( "import csv=reads separator=" + ( tabSeparator ? "tab" : "comma" ) + " file='" + fileName + "' fNames=" + Basic . toString ( cNames , " " ) + " topPercent=" + topPercent + " minScore=" + minScore + " minSupportPercent=" + minSupportPercent + " minSupport=" + minSupport + ";" , newDir . getMainViewer ( ) . getCommandManager ( ) )  
doc . getMeganFile ( ) . setFileType ( MeganFile . Type . MEGAN_SUMMARY_FILE )  
doc . setDirty ( true )  
if ( doc . getNumberOfSamples ( ) > 1 ) 
newDir . executeImmediately ( "import csv=summary separator=" + ( tabSeparator ? "tab" : "comma" ) + " file='" + fileName + "' fNames=" + Basic . toString ( cNames , " " ) + ( multiplier != 1 ? " multiplier=" + multiplier : "" ) + ";" , newDir . getMainViewer ( ) . getCommandManager ( ) )  
final Match match = new Match ( )  
final StringBuilder buf = new StringBuilder ( )  
if ( hit . accession != null ) 
buf . append ( hit . accession ) . append ( " " )  
if ( hit . id != null ) 
buf . append ( hit . id ) . append ( " " )  
match . setSamLine ( makeSAM ( iteration . queryDef , buf . toString ( ) . replaceAll ( "\\s+" , " " ) , hit . len , hsp . bitScore , ( float ) hsp . eValue , ( int ) hsp . score , hsp . identity , hsp . queryFrame , queryStart , queryEnd , ( int ) hsp . hitFrom , ( int ) hsp . hitTo , hsp . qSeq , hsp . hSeq ) )  
buf . append ( match . getSamLine ( ) ) . append ( "\n" )  
