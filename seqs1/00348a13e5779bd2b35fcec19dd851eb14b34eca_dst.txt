IdentifierSourceService iss = Context . getService ( IdentifierSourceService . class )  
IdentifierSource idSource = iss . getIdentifierSource ( 1 ) ; 
PatientIdentifierType patientIdentifierType = patientService . getPatientIdentifierTypeByUuid ( "05a29f94-c0ed-11e2-94be-8c13b969e334" )  
PatientIdentifier pid = new PatientIdentifier ( )  
pid . setIdentifierType ( patientIdentifierType )  
pid . setIdentifier ( iss . generateIdentifier ( idSource , "New OpenMRS ID with CheckDigit" ) )  
pid . setPreferred ( true )  
for ( List < Object > row : patientIds )  
pid . setIdentifier ( iss . generateIdentifier ( idSource , "New OpenMRS ID with CheckDigit" ) )  
patientService . savePatient ( p )  
log . info ( "Adding OpenMRS ID " + pid . getIdentifier ( ) + " to patient with id " + p . getPatientId ( ) )  
p . addIdentifier ( pid )  
} catch ( Exception e )  
log . error ( "Error updating OpenMRS identifier for patient #" + p . getPatientId ( ) , e )  
public void stopped ( )  
